(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/danger/addDanger"],{"5bf1":function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("17f7")),o=s(n("3731")),u=(s(n("59a9")),n("2f62"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){c(e,t,n[t])})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(){return n.e("components/list/uni-list/uni-list").then(n.bind(null,"7c03"))},d=function(){return n.e("components/list/uni-icon/uni-icon").then(n.bind(null,"ba08"))},l=function(){return n.e("components/list/uni-list-item/uni-list-item").then(n.bind(null,"4b9c"))},h={computed:(0,u.mapState)(["sublistItem","sublistIndex","userInfo","inputPageText","key"]),components:{uniList:f,uniListItem:l,uniIcon:d},data:function(){return{needGetInputOnShow:!1,item:"",itemIndex:0,imageViewHeight:100,imageList:[],littleImageWidth:0,id:"",yhdj:"",yhhg:"",bhgys:"",wfflfgjtk:"",gsyqjjy:"",zrbm:"",fqr:"",fj:"",yhdjData:["一般隐患","重大隐患"],yhhgData:["人员伤害","财产损失","其他"],zrbmData:["从隐患库选择/检索","自行输入问题","从部门库选择"]}},onLoad:function(){var t=this;t.littleImageWidth=(e.getSystemInfoSync().windowWidth-50)/4,t.fqr=t.userInfo.fullname,o.default.requestLoadingNew(a.default.getUserDeptName,{userid:t.userInfo.userid},"正在加载",function(e){t.zrbm=e.dept},function(){},function(){})},onNavigationBarButtonTap:function(){},onShow:function(){1==this.needGetInputOnShow&&(this.$data[this.key]=this.inputPageText,this.needGetInputOnShow=!1,this.removeInputItem())},methods:r({},(0,u.mapMutations)(["removeInputItem","setSublistItem"]),{selectedyhdj:function(t){var n=this;e.showActionSheet({itemList:n.yhdjData,success:function(e){n.yhdj=n.yhdjData[e.tapIndex]},fail:function(e){console.log(i(e.errMsg," at pages/danger/addDanger.vue:120"))}})},selectedyhhg:function(t){var n=this;e.showActionSheet({itemList:n.yhhgData,success:function(e){n.yhhg=n.yhhgData[e.tapIndex]},fail:function(e){console.log(i(e.errMsg," at pages/danger/addDanger.vue:133"))}})},checkDateChange:function(e){this.checkDate=e.target.value},deadLineChange:function(e){this.deadLine=e.target.value},saveItem:function(t){for(var n=this,i=a.default.uploadImage+"?from=flowyh&yyid="+n.id+"&fjlx=fj1&userid="+n.userInfo.userid,u=[],s=0;s<n.imageList.length;s++){var r=n.imageList[s];1!=r.type||r.src.startsWith("http:")||u.push(r.src)}if(0==u.length)return n.saveLocalItem(),void e.navigateBack({delta:1});e.showLoading({title:"正在上传图片"}),o.default.uploadImage(i,u,0,0,0,u.length,function(e){var t=JSON.parse(e.data),i=t.fj;n.fj=i},function(t){e.hideLoading(),"200"==t&&(n.saveLocalItem(),e.showToast({title:"上传成功",complete:setTimeout(function(){e.navigateBack({delta:1})},1500)}))})},saveLocalItem:function(){var e={item:this.item,index:this.itemIndex};this.setSublistItem(e)},saveClick:function(){var t=this,n={refid:t.id,yhdj:t.yhdj,yhhg:t.yhhg,bhgys:t.bhgys,wfflfgjtk:t.wfflfgjtk,gsyqjjy:t.gsyqjjy,zrbm:t.zrbm,fqr:t.fqr,userid:t.userInfo.userid};o.default.requestLoadingNew(a.default.addYhzgToFlow,n,"正在加载",function(n){e.showToast({icon:"none",title:"保存成功",duration:1e3}),console.log(i(""+JSON.stringify(n)," at pages/danger/addDanger.vue:217")),t.id=n.id,console.log(i(t.id," at pages/danger/addDanger.vue:219")),t.saveItem()},function(){e.showToast({icon:"none",title:"保存失败"})},function(){})},jumpInput:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"请输入描述";this.needGetInputOnShow=!0,e.navigateTo({url:"../common/inputPage?text="+t+"&key="+n+"&placeholder="+i})},addPhoto:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){console.log(i(JSON.stringify(e.tempFilePaths)," at pages/danger/addDanger.vue:244"));for(var n=0;n<e.tempFilePaths.length;n++){var a={fileid:"",src:e.tempFilePaths[n],type:1};t.imageList.push(a)}}})},deleteImage:function(t,n){var u=this;if(t.src.startsWith("http:")){var s={item:u.item,index:u.itemIndex};u.setSublistItem(s);var r={from:"jc",yyid:u.item.id,fileid:t.fileid,userid:u.userInfo.userid};o.default.requestLoading(a.default.deleteImage,r,"正在删除图片",function(e){console.log(i("删除成功："+JSON.stringify(e)," at pages/danger/addDanger.vue:274")),u.item.fj=e.fj,u.imageList.splice(n,1)},function(){e.showToast({icon:"none",title:"删除失败"})},function(){})}else u.imageList.splice(n,1)},viewPhoto:function(){for(var t=this,n=[],i=0;i<t.imageList.length;i++){var a=t.imageList[i];n.push(a.src)}e.previewImage({urls:n})}})};t.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},7058:function(e,t,n){"use strict";n.r(t);var i=n("8e79"),a=n("c5e3");for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);n("712e");var u=n("2877"),s=Object(u["a"])(a["default"],i["a"],i["b"],!1,null,null,null);t["default"]=s.exports},"712e":function(e,t,n){"use strict";var i=n("c43f"),a=n.n(i);a.a},"8e79":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a})},a35e:function(e,t,n){"use strict";(function(e){n("de83"),n("921b");i(n("66fd"));var t=i(n("7058"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},c43f:function(e,t,n){},c5e3:function(e,t,n){"use strict";n.r(t);var i=n("5bf1"),a=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);t["default"]=a.a}},[["a35e","common/runtime","common/vendor"]]]);