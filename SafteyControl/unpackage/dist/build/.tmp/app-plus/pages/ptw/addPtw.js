(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ptw/addPtw"],{"020f":function(t,e,n){"use strict";n.r(e);var i=n("eefe"),s=n("5ffa");for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);n("8a5f");var o=n("2877"),u=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=u.exports},"5ffa":function(t,e,n){"use strict";n.r(e);var i=n("bae2"),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=s.a},"7c90":function(t,e,n){},"8a5f":function(t,e,n){"use strict";var i=n("7c90"),s=n.n(i);s.a},"958b":function(t,e,n){"use strict";(function(t){n("de83"),n("921b");i(n("66fd"));var e=i(n("020f"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},bae2:function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=u(n("17f7")),a=u(n("3731")),o=(u(n("59a9")),n("2f62"));function u(t){return t&&t.__esModule?t:{default:t}}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(){return n.e("components/list/uni-list/uni-list").then(n.bind(null,"7c03"))},l=function(){return n.e("components/list/uni-icon/uni-icon").then(n.bind(null,"ba08"))},f=function(){return n.e("components/list/uni-list-item/uni-list-item").then(n.bind(null,"4b9c"))},h={computed:(0,o.mapState)(["sublistItem","sublistIndex","userInfo","inputPageText","key"]),components:{uniList:c,uniListItem:f,uniIcon:l},data:function(){return{needGetInputOnShow:!1,imageViewHeight:100,imageList:[],littleImageWidth:0,item:"",itemIndex:0,id:"",dhzlx:"",zydw:"",dhfzr:"",dhfs:"",dhdd:"",sgxm:"",dhnr:"",zzjhr:"",zzjhrgw:"",ddjhr:"",ddjhrgw:"",whbs:"",dhqx:"",dhqx2:"",sfjxfxfx:"",sfyss:"",fj:"",aqcs:"",ssqk:"",sfData:["是","否"],dhzlxData:["特殊危险动火","一级动火","二级动火"]}},onLoad:function(){this.littleImageWidth=(t.getSystemInfoSync().windowWidth-50)/4},onNavigationBarButtonTap:function(){},onShow:function(){1==this.needGetInputOnShow&&(this.$data[this.key]=this.inputPageText,this.needGetInputOnShow=!1,this.removeInputItem())},methods:d({},(0,o.mapMutations)(["removeInputItem","setSublistItem"]),{selecteddhzlx:function(e){var n=this;t.showActionSheet({itemList:n.dhzlxData,success:function(t){n.dhzlx=n.dhzlxData[t.tapIndex]},fail:function(t){console.log(i(t.errMsg," at pages/ptw/addPtw.vue:143"))}})},selectedsfjxfxfx:function(e){var n=this;t.showActionSheet({itemList:n.sfData,success:function(t){n.sfjxfxfx=n.sfData[t.tapIndex]},fail:function(t){console.log(i(t.errMsg," at pages/ptw/addPtw.vue:155"))}})},selectedsfyss:function(e){var n=this;t.showActionSheet({itemList:n.sfData,success:function(t){n.sfyss=n.sfData[t.tapIndex]},fail:function(t){console.log(i(t.errMsg," at pages/ptw/addPtw.vue:167"))}})},bindDateDhqx:function(t){this.dhqx=t.target.value},bindDateDhqx2:function(t){this.dhqx2=t.target.value},saveItem:function(e){for(var n=this,i=s.default.uploadImage+"?from=ptw&yyid="+n.id+"&userid="+n.userInfo.userid,o=[],u=0;u<n.imageList.length;u++){var d=n.imageList[u];1!=d.type||d.src.startsWith("http:")||o.push(d.src)}0!=o.length?(t.showLoading({title:"正在上传图片"}),a.default.uploadImage(i,o,0,0,0,o.length,function(t){var e=JSON.parse(t.data),i=e.fj;n.fj=i},function(e){t.hideLoading()})):n.saveLocalItem()},saveLocalItem:function(){var t={item:this.item,index:this.itemIndex};this.setSublistItem(t)},choiceICON:function(){var e=this,n=e.id;n?t.navigateTo({url:"rapSelected?recordid="+n}):t.showToast({icon:"none",title:"请先保存作业"})},savePTW:function(){this.saveClick(s.default.savePTW)},savePTWFlow:function(){this.saveClick(s.default.savePTWFlow)},saveAndClose:function(){var e=this;e.saveClick(s.default.savePTW),e.saveLocalItem(),t.showToast({title:"保存成功，即将关闭",complete:setTimeout(function(){t.navigateBack({delta:1})},1500)})},closeBtn:function(){var e=this;e.saveLocalItem(),t.showToast({title:"即将关闭",complete:setTimeout(function(){t.navigateBack({delta:1})},1500)})},saveClick:function(e){var n=this,s={userid:n.userInfo.userid,dhzlx:n.dhzlx,zydw:n.zydw,dhfzr:n.dhfzr,dhfs:n.dhfs,dhdd:n.dhdd,sgxm:n.sgxm,dhnr:n.dhnr,zzjhr:n.zzjhr,zzjhrgw:n.zzjhrgw,ddjhr:n.ddjhr,ddjhrgw:n.ddjhrgw,whbs:n.whbs,dhqx:n.dhqx,dhqx2:n.dhqx2,sfjxfxfx:n.sfjxfxfx,sfyss:n.sfyss,aqcs:n.aqcs,ssqk:n.ssqk},o=[{val:n.zydw,msg:"作业单位"},{val:n.dhfzr,msg:"动火负责人"},{val:n.dhfs,msg:"动火方式"},{val:n.dhdd,msg:"动火地点"},{val:n.sgxm,msg:"施工项目"},{val:n.dhnr,msg:"动火内容"},{val:n.zzjhr,msg:"组织监火人"},{val:n.zzjhrgw,msg:"组织监火人岗位"},{val:n.ddjhr,msg:"地点监火人"},{val:n.ddjhrgw,msg:"地点监火人岗位"},{val:n.whbs,msg:"危害辨识"},{val:n.aqcs,msg:"安全措施"},{val:n.ssqk,msg:"实施情况"}];n.checkVal(o)&&a.default.requestLoadingNew(e,s,"正在加载",function(e){t.showToast({icon:"none",title:"保存成功",duration:1e3}),console.log(i(""+JSON.stringify(e)," at pages/ptw/addPtw.vue:302")),n.id=e.id,console.log(i(n.id," at pages/ptw/addPtw.vue:304")),n.saveItem()},function(){t.showToast({icon:"none",title:"保存失败"})},function(){})},jumpInput:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"请输入描述";this.needGetInputOnShow=!0,t.navigateTo({url:"../common/inputPage?text="+e+"&key="+n+"&placeholder="+i})},addPhoto:function(){var e=this;t.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){console.log(i(JSON.stringify(t.tempFilePaths)," at pages/ptw/addPtw.vue:329"));for(var n=e.imageList,s=0;s<t.tempFilePaths.length;s++){var a={fileid:"",src:t.tempFilePaths[s],type:1};n.push(a)}}})},checkVal:function(e){for(var n in e)if(!e[n].val)return t.showToast({icon:"none",title:e[n].msg+"不能为空！"}),!1;return!0},deleteImage:function(e,n){var o=this;if(e.src.startsWith("http:")){var u={item:o.item,index:o.itemIndex};o.setSublistItem(u);var d={from:"jc",yyid:o.item.id,fileid:e.fileid,userid:o.userInfo.userid};a.default.requestLoading(s.default.deleteImage,d,"正在删除图片",function(t){console.log(i("删除成功："+JSON.stringify(t)," at pages/ptw/addPtw.vue:373"));var e=o.imageList;o.item.fj=t.fj,e.splice(n,1)},function(){t.showToast({icon:"none",title:"删除失败"})},function(){})}else imageList.splice(n,1)},viewPhoto:function(){for(var e=this,n=[],i=e.imageList,s=0;s<i.length;s++){var a=i[s];n.push(a.src)}t.previewImage({urls:n})}})};e.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},eefe:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})}},[["958b","common/runtime","common/vendor"]]]);