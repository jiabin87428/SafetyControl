(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pointAdd/pointAdd"],{"26bb":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"baseView"},[t._m(0),i("view",{staticClass:"cellInfoView"},[i("uni-list",{attrs:{mpcomid:"7c552558-6"}},[i("uni-list-item",{attrs:{title:"点位编号",subnote:t.obj.dwbh,"show-arrow":"false","show-badge":"true",mpcomid:"7c552558-0"}}),i("uni-list-item",{attrs:{title:"检查人",subnote:t.obj.zrrmc,"show-arrow":"false",mpcomid:"7c552558-1"}}),i("picker",{attrs:{mode:"date",value:t.obj.jcrq,eventid:"7c552558-0"},on:{change:t.bindDateChange}},[i("uni-list-item",{attrs:{title:"检查日期",subnote:t.obj.jcrq,mpcomid:"7c552558-2"}})],1),i("uni-list-item",{attrs:{title:"责任部门",subnote:t.obj.zrbm,"show-arrow":"false",mpcomid:"7c552558-3"}}),i("uni-list-item",{attrs:{title:"楼层",subnote:t.obj.lc,"show-arrow":"false",mpcomid:"7c552558-4"}}),i("uni-list-item",{attrs:{title:"位置",subnote:t.obj.wz,"show-arrow":"false",mpcomid:"7c552558-5"}})],1)],1),i("view",{staticClass:"cellTitleView"},[i("text",{staticClass:"cellTitle"},[t._v("检查信息")]),i("text",{staticClass:"cellTitle"},[t._v("正常-")]),i("uni-icon",{attrs:{type:"checkbox-filled",size:"22",color:"#24BE41",mpcomid:"7c552558-7"}}),i("text",{staticClass:"cellTitle"},[t._v("未检-")]),i("uni-icon",{attrs:{type:"info-filled",size:"22",color:"#FFDE52",mpcomid:"7c552558-8"}}),i("text",{staticClass:"cellTitle"},[t._v("异常-")]),i("uni-icon",{attrs:{type:"clear",size:"22",color:"#C11E1E",mpcomid:"7c552558-9"}})],1),i("view",{staticClass:"cellInfoView"},[i("uni-list",{attrs:{mpcomid:"7c552558-11"}},t._l(t.obj.sublist,function(e,s){return i("uni-list-item",{key:s,attrs:{title:e.jcbz,note:e.jcwtms,"show-extra-icon":"true","show-arrow":t.editable,"extra-icon":t.getIcon(e),eventid:"7c552558-1-"+s,mpcomid:"7c552558-10-"+s},on:{click:function(i){t.jumpEdit(e,s)}}})}))],1),i("view",{staticClass:"btnView"},[t.showSave?i("button",{staticClass:"saveBtn",attrs:{eventid:"7c552558-2"},on:{tap:t.saveClick}},[t._v("保存")]):t._e(),t.showClose?i("button",{staticClass:"closeBtn",attrs:{eventid:"7c552558-3"},on:{tap:t.closeClick}},[t._v("关单")]):t._e()],1)])},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"cellTitleView"},[i("text",{staticClass:"cellTitle"},[t._v("基础信息")])])}];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return o})},3998:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=r(i("7cb5")),o=r(i("5718")),n=r(i("1578")),c=r(i("f5eb")),l=r(i("6c6c")),a=r(i("89f5")),u=i("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},s=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),s.forEach(function(e){f(t,e,i[e])})}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b={computed:(0,u.mapState)(["sublistItem","sublistIndex","userInfo"]),components:{uniList:s.default,uniListItem:n.default,uniIcon:o.default},data:function(){return{needGetItemOnShow:!1,showClose:!1,showSave:!1,editable:!1,backPressFlag:!0,obj:"",normal:{color:"#24BE41",size:"22",type:"checkbox-filled"},undetected:{color:"#FFDE52",size:"22",type:"info-filled"},abnormal:{color:"#C11E1E",size:"22",type:"clear"}}},onLoad:function(t){this.obj=JSON.parse(t.obj),this.checkShowClose()},onNavigationBarButtonTap:function(){var e=this;0!=e.editable?t.showModal({title:"提示",content:"确认要设置所有的检查点都正常吗？",success:function(t){if(t.confirm)for(var i=0;i<e.obj.sublist.length;i++){var s=e.obj.sublist[i];s["jcjl"]="正常",s["jcwtms"]="",s["zgfs"]=""}else t.cancel}}):t.showToast({icon:"none",title:"已关单 无法编辑",duration:1e3})},onBackPress:function(){var e=this;if(1==e.backPressFlag)return t.showModal({title:"请确认是否有修改需要保存",content:"如果直接返回，所有修改将不作保存。",confirmText:"保存一下",cancelText:"直接返回",success:function(i){i.confirm?e.saveClick():i.cancel&&(e.backPressFlag=!1,console.log("backPressFlag2: "+e.backPressFlag),t.navigateBack({delta:1}))}}),console.log("backPressFlag1: "+e.backPressFlag),e.backPressFlag},onShow:function(){1==this.needGetItemOnShow&&null!=this.sublistIndex&&null!=this.sublistItem&&(console.log(""+JSON.stringify(this.sublistItem)),this.obj.sublist[this.sublistIndex]=this.sublistItem,this.removeSublistItem(),console.log("1111111")),this.needGetItemOnShow=!1},methods:d({},(0,u.mapMutations)(["removeSublistItem"]),{bindDateChange:function(t){this.obj.jcrq=t.target.value},jumpEdit:function(e,i){0!=this.editable&&(this.needGetItemOnShow=!0,t.navigateTo({url:"./pointCheckInfo?item="+JSON.stringify(e)+"&index="+i}))},getIcon:function(t){return"正常"==t.jcjl?this.normal:"异常"==t.jcjl?this.abnormal:this.undetected},saveClick:function(){var e=this,i=a.default.copyObj(e.obj);i["userid"]=e.userInfo.userid,i["sublist"]=JSON.stringify(i["sublist"]),l.default.requestLoading(c.default.UpdatePoint,i,"正在加载",function(i){t.showToast({icon:"none",title:"保存成功",duration:1e3}),e.obj.id=i.id,e.checkShowClose()},function(){t.showToast({icon:"none",title:"保存失败"})},function(){})},closeClick:function(){var e=this,i=a.default.copyObj(e.obj);i["userid"]=e.userInfo.userid,i["sublist"]=JSON.stringify(i["sublist"]),i["status"]="2",l.default.requestLoading(c.default.UpdatePoint,i,"正在加载",function(i){t.showToast({icon:"none",title:"关单成功",duration:1e3}),e.obj.status=i.status,e.obj.id=i.id,e.checkShowClose()},function(){t.showToast({icon:"none",title:"关单失败"})},function(){})},checkShowClose:function(){"1"==this.obj.status&&null!=this.obj.id&&""!=this.obj.id?this.showClose=!0:this.showClose=!1,"2"==this.obj.status?(this.showSave=!1,this.editable=!1):(this.showSave=!0,this.editable=!0)}})};e.default=b}).call(this,i("649d")["default"])},8310:function(t,e,i){"use strict";i.r(e);var s=i("3998"),o=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e["default"]=o.a},"91db":function(t,e,i){},"99ec":function(t,e,i){"use strict";i("835e");var s=n(i("b0ce")),o=n(i("9e7f"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(o.default))},"9e7f":function(t,e,i){"use strict";i.r(e);var s=i("26bb"),o=i("8310");for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);i("a133");var c=i("2877"),l=Object(c["a"])(o["default"],s["a"],s["b"],!1,null,null,null);e["default"]=l.exports},a133:function(t,e,i){"use strict";var s=i("91db"),o=i.n(s);o.a}},[["99ec","common/runtime","common/vendor"]]]);