(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/danger/addDanger"],{"63dd":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:"baseView"},[n("view",{staticClass:"cellInfoView"},[n("view",{staticClass:"imageBaseView"},[n("view",{staticClass:"cellSubViewRow"},[n("text",{staticClass:"leftTextRow"},[e._v("隐患照片")]),n("text",{staticClass:"rightTextRow"},[e._v(e._s(e.imageList.length))])]),n("view",{staticClass:"imageView",attrs:{id:"imageView"}},[e._l(e.imageList,function(t,i){return n("block",{key:i},[n("view",{staticClass:"littleImageView",style:{width:e.littleImageWidth+"px",height:e.littleImageWidth+"px"}},[n("image",{staticClass:"littleImage",attrs:{id:i,src:t.src,mode:"aspectFit",eventid:"72ed35ad-0-"+i},on:{click:e.viewPhoto}}),n("image",{staticClass:"littleImageDelete",attrs:{src:"../../static/img/delete.png",id:i,mode:"aspectFit",eventid:"72ed35ad-1-"+i},on:{click:function(n){e.deleteImage(t,i)}}})])])}),n("view",{staticClass:"littleImageView",style:{width:e.littleImageWidth+"px",height:e.littleImageWidth+"px"},attrs:{eventid:"72ed35ad-2"},on:{click:e.addPhoto}},[n("image",{staticClass:"littleImage",attrs:{src:"../../static/img/addImage.png"}})])],2)]),n("uni-list",{attrs:{mpcomid:"72ed35ad-8"}},[n("uni-list-item",{attrs:{title:"隐患级别",subnote:e.dangerLevel,"show-arrow":"true",eventid:"72ed35ad-3",mpcomid:"72ed35ad-0"},on:{click:e.selectedDangerLevel}}),n("uni-list-item",{attrs:{title:"隐患分类",subnote:e.dangerType,"show-arrow":"true",eventid:"72ed35ad-4",mpcomid:"72ed35ad-1"},on:{click:e.selectedDangerType}}),n("uni-list-item",{attrs:{title:"隐患描述",subnote:e.dangerDesc,"show-arrow":"true",eventid:"72ed35ad-5",mpcomid:"72ed35ad-2"},on:{click:e.selectedDangerDesc}}),n("uni-list-item",{attrs:{title:"对应条款",subnote:e.dangerClause,"show-arrow":"true",eventid:"72ed35ad-6",mpcomid:"72ed35ad-3"},on:{click:e.selectedDangerClause}}),n("uni-list-item",{attrs:{title:"整改建议",subnote:e.dangerAdvise,"show-arrow":"true",eventid:"72ed35ad-7",mpcomid:"72ed35ad-4"},on:{click:function(t){e.jumpInput(e.dangerAdvise,"dangerAdvise","请输入整改建议")}}}),n("picker",{attrs:{mode:"date",value:e.checkDate,eventid:"72ed35ad-8"},on:{change:e.checkDateChange}},[n("uni-list-item",{attrs:{title:"检查日期",subnote:e.checkDate,mpcomid:"72ed35ad-5"}})],1),n("uni-list-item",{attrs:{title:"检查人",subnote:e.checkPeople,"show-arrow":"true",mpcomid:"72ed35ad-6"}}),n("picker",{attrs:{mode:"date",value:e.deadLine,eventid:"72ed35ad-9"},on:{change:e.deadLineChange}},[n("uni-list-item",{attrs:{title:"整改期限",subnote:e.deadLine,mpcomid:"72ed35ad-7"}})],1)],1)],1),n("view",{staticClass:"btnView"},[n("button",{staticClass:"saveBtn",attrs:{eventid:"72ed35ad-10"},on:{tap:e.saveClick}},[e._v("保存")])],1)])},a=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a})},7058:function(e,t,n){"use strict";n.r(t);var i=n("63dd"),a=n("c5e3");for(var s in a)"default"!==s&&function(e){n.d(t,e,function(){return a[e]})}(s);n("712e");var d=n("2877"),o=Object(d["a"])(a["default"],i["a"],i["b"],!1,null,null,null);t["default"]=o.exports},"712e":function(e,t,n){"use strict";var i=n("b60b"),a=n.n(i);a.a},"728d":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("7c03")),a=r(n("ba08")),s=r(n("4b9c")),d=r(n("17f7")),o=r(n("3731")),c=(r(n("59a9")),n("2f62"));function r(e){return e&&e.__esModule?e:{default:e}}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){u(e,t,n[t])})}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g={computed:(0,c.mapState)(["sublistItem","sublistIndex","userInfo","inputPageText","key"]),components:{uniList:i.default,uniListItem:s.default,uniIcon:a.default},data:function(){return{needGetInputOnShow:!1,imageViewHeight:100,imageList:[],littleImageWidth:0,dangerId:"",dangerLevel:"",dangerType:"",dangerDesc:"",dangerClause:"",dangerAdvise:"",checkDate:"",checkPeople:"",deadLine:"",dangerLevelData:["一般隐患","重大隐患"],dangerTypeData:["自行输入分类","从分类库选择"],dangerDescData:["从隐患库选择/检索","自行输入问题","从常用隐患库选择"],dangerClauseData:["从隐患库选择/检索","自行输入问题","从法规库选择"]}},onLoad:function(){this.littleImageWidth=(e.getSystemInfoSync().windowWidth-50)/4,this.checkPeople=this.userInfo.fullname},onNavigationBarButtonTap:function(){},onShow:function(){1==this.needGetInputOnShow&&(this.$data[this.key]=this.inputPageText,this.needGetInputOnShow=!1,this.removeInputItem())},methods:l({},(0,c.mapMutations)(["removeInputItem"]),{selectedDangerLevel:function(t){var n=this;e.showActionSheet({itemList:n.dangerLevelData,success:function(e){n.dangerLevel=n.dangerLevelData[e.tapIndex]},fail:function(e){console.log(e.errMsg)}})},selectedDangerType:function(t){var n=this;e.showActionSheet({itemList:n.dangerTypeData,success:function(e){0==e.tapIndex&&(this.needGetInputOnShow=!0,n.jumpInput(n.dangerType,"dangerType","请输入隐患分类"))},fail:function(e){console.log(e.errMsg)}})},selectedDangerDesc:function(t){var n=this;e.showActionSheet({itemList:n.dangerDescData,success:function(e){0==e.tapIndex||1==e.tapIndex&&(this.needGetInputOnShow=!0,n.jumpInput(n.dangerDesc,"dangerDesc","请输入隐患描述"))},fail:function(e){console.log(e.errMsg)}})},selectedDangerClause:function(t){var n=this;e.showActionSheet({itemList:n.dangerClauseData,success:function(e){0==e.tapIndex||1==e.tapIndex&&(this.needGetInputOnShow=!0,n.jumpInput(n.dangerClause,"dangerClause","请输入对应条款"))},fail:function(e){console.log(e.errMsg)}})},checkDateChange:function(e){this.checkDate=e.target.value},deadLineChange:function(e){this.deadLine=e.target.value},saveClick:function(){var t=this,n={refid:t.dangerId,yhjb:t.dangerLevel,yhfl:t.dangerType,yhms:t.dangerDesc,dytk:t.dangerClause,zgjy:t.dangerAdvise,jcsj:t.checkDate,jcr:t.checkPeople,zgqx:t.deadLine,userid:t.userInfo.userid};o.default.requestLoading(d.default.editDanger,n,"正在加载",function(n){e.showToast({icon:"none",title:"保存成功",duration:1e3}),t.dangerId=n.id},function(){e.showToast({icon:"none",title:"保存失败"})},function(){})},jumpInput:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"请输入描述";this.needGetInputOnShow=!0,e.navigateTo({url:"../common/inputPage?text="+t+"&key="+n+"&placeholder="+i})},addPhoto:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){console.log(JSON.stringify(e.tempFilePaths));for(var n=0;n<e.tempFilePaths.length;n++){var i={fileid:"",src:e.tempFilePaths[n],type:1};t.imageList.push(i)}}})},deleteImage:function(t,n){var i=this;if(t.src.startsWith("http:")){var a={item:i.item,index:i.itemIndex};i.setSublistItem(a);var s={from:"jc",yyid:i.item.id,fileid:t.fileid,userid:i.userInfo.userid};o.default.requestLoading(d.default.deleteImage,s,"正在删除图片",function(e){console.log("删除成功："+JSON.stringify(e)),i.item.fj=e.fj,i.imageList.splice(n,1)},function(){e.showToast({icon:"none",title:"删除失败"})},function(){})}else i.imageList.splice(n,1)},viewPhoto:function(){for(var t=this,n=[],i=0;i<t.imageList.length;i++){var a=t.imageList[i];n.push(a.src)}e.previewImage({urls:n})}})};t.default=g}).call(this,n("649d")["default"])},a35e:function(e,t,n){"use strict";n("de83");var i=s(n("b0ce")),a=s(n("7058"));function s(e){return e&&e.__esModule?e:{default:e}}Page((0,i.default)(a.default))},b60b:function(e,t,n){},c5e3:function(e,t,n){"use strict";n.r(t);var i=n("728d"),a=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);t["default"]=a.a}},[["a35e","common/runtime","common/vendor"]]]);